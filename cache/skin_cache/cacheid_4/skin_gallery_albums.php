<?php
/*--------------------------------------------------*/
/* FILE GENERATED BY INVISION POWER BOARD 3         */
/* CACHE FILE: Skin set id: 4               */
/* CACHE FILE: Generated: Wed, 29 Aug 2012 14:15:07 GMT */
/* DO NOT EDIT DIRECTLY - THE CHANGES WILL NOT BE   */
/* WRITTEN TO THE DATABASE AUTOMATICALLY            */
/*--------------------------------------------------*/

class skin_gallery_albums_4 extends skinMaster{

/**
* Construct
*/
function __construct( ipsRegistry $registry )
{
	parent::__construct( $registry );
	

$this->_funcHooks = array();
$this->_funcHooks['albumFeatureView'] = array('isUserViewList','comments','isOverviewView','images','isPrivate','isUserViewStart','hasRules','canIuploadDearSirWellCanI','hasComments','hasPages','hasRecent');
$this->_funcHooks['albumSelector'] = array('isLargeTouch');
$this->_funcHooks['albumSelectorPanel'] = array('separator','nav','parents','children','isThisAlbum','hasParents','hasChildren','isNotGlobal','hasImages','restrictUpload','outer','isSearch','hasNav','canMoveToRoot','hazAlbums');
$this->_funcHooks['albumView'] = array('moderate','comments','images','hasFollow','guestrate1','filerate1','endguestrate1','guestrate2','filerate2','endguestrate2','guestrate3','filerate3','endguestrate3','guestrate4','ralerate4','endguestrate4','guestrate5','filerate5','endguestrate5','filevotes','fileyourvote','filejsvotes','filejsallowvote','checkGuestRate','isPrivate','hasExpandedTextRules','hasRules','hasPagesTop','canIuploadDearSirWellCanI','hasImages','hasPagesBottom','hasShareLinks','albumMod');
$this->_funcHooks['albumViewDetail'] = array('albumrate','ratingLoop','albumIsGlobal','hasDescription','hasLittleWeeBabbies','albumIsMember','results','imageIsUnapproved','moderate','imageHasDescription','hasFollow','guestrate1','filerate1','endguestrate1','guestrate2','filerate2','endguestrate2','guestrate3','filerate3','endguestrate3','guestrate4','ralerate4','endguestrate4','guestrate5','filerate5','endguestrate5','filevotes','fileyourvote','filejsvotes','filejsallowvote','checkGuestRate','isPrivate','hasExpandedTextRules','hasRules','hasPagesTop','canIuploadDearSirWellCanI','hasKids','hasPagesBottom','hasShareLinks','albumMod');
$this->_funcHooks['boardIndexEntry'] = array('hideLastInfo','isContainerOnly');
$this->_funcHooks['deleteAlbumDialogue'] = array('hasAlbums','hasKids');
$this->_funcHooks['miniAlbumStripHorizontal'] = array('latestImgs','terabyteWillComplainIfIDontAddThisHookId','hasSubChildren','hasSubChildren','notContainer','hasCount','isGlobal','hasTitle','hasmore','noAlbums');
$this->_funcHooks['miniAlbumStripSubAlbums'] = array('isNotLast','hasMore','subAlbums');
$this->_funcHooks['miniLatestCommentBlock'] = array('hasMember','imagesLoop','hasTitle');
$this->_funcHooks['newAlbumDialogue'] = array('canPrivate');
$this->_funcHooks['userCpAlbumIndexView'] = array('canUploadToAlbum','canUploadToAlbum','canUploadToAlbum','showAlbumOptions','albumIsFriendOnly','albumIsPrivate','hasDescription','albumIsUploadable','albums','canIuploadDearSirWellCanI','hasalbums');


}

/* -- albumFeatureView --*/
function albumFeatureView($feature, $recents, $album, $children, $childrenTitle, $sideblocks=array(), $comments='', $childrenRootCount=0, $isUserView=false, $subAlbums=array()) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['albumFeatureView'] ) )
{
$count_46890c62f4e0d11c9b4967e7b216d8f4 = is_array($this->functionData['albumFeatureView']) ? count($this->functionData['albumFeatureView']) : 0;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['feature'] = $feature;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['recents'] = $recents;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['album'] = $album;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['children'] = $children;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['childrenTitle'] = $childrenTitle;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['sideblocks'] = $sideblocks;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['comments'] = $comments;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['childrenRootCount'] = $childrenRootCount;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['isUserView'] = $isUserView;
$this->functionData['albumFeatureView'][$count_46890c62f4e0d11c9b4967e7b216d8f4]['subAlbums'] = $subAlbums;
}
$IPBHTML .= "<script type=\"text/javascript\">
 ipb.gallery.inSection = 'albumOverview';
 ipb.gallery.albumId   = parseInt({$album['album_id']});
 ipb.gallery.albumUrl  = \"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "\";
</script>
" . (($isUserView) ? ("
	<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "showuser={$album['owner']['member_id']}", "public",'' ), "{$album['owner']['members_seo_name']}", "showuser" ) . "' class='ipsUserPhotoLink left'>
		<img src='{$album['owner']['pp_small_photo']}' class='ipsUserPhoto ipsUserPhoto_medium' />
	</a>
	<div class='ipsBox_withphoto'>
		<h1 class='ipsType_pagetitle'>{$album['album_name_userview']}</h1>
		<span class='desc'>{$this->lang->words['joined_ucfirst']}: " . $this->registry->getClass('class_localization')->getDate($album['owner']['joined'],"joined", 0) . "</span>
	</div>
") : ("<h1 class='ipsType_pagetitle'>
		" . (($this->registry->gallery->helper('albums')->isPrivate($album) === true) ? ("
			<span class='ipsBadge ipsBadge_red reset_cursor'>{$this->lang->words['private_ucfirst']}</span>
		") : ("")) . "
		{$album['album_name']}
	</h1>")) . "
" . ((is_array( $album['album_g_rules_expanded'] )) ? ("<div class='ipsType_pagedesc forum_rules'>
		" . (($album['album_g_rules_expanded']['text']) ? ("
			<strong>{$album['album_g_rules_expanded']['title']}</strong>
			{$album['album_g_rules_expanded']['text']}
		") : ("
			{$album['album_description']}
		")) . "
	</div>") : ("")) . "
" . (($this->registry->gallery->helper('albums')->isUploadable($album) || $this->registry->gallery->helper('albums')->canCreateSubAlbumInside($album)) ? ("
	<div class='topic_controls'>
		<ul class='topic_buttons'>
			<li><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=post&amp;section=image&amp;album_id={$album['album_id']}", "public",'' ), "", "" ) . "' title='{$this->lang->words['upload']}'>{$this->lang->words['upload']}</a></li>
		</ul>
	</div>
") : ("")) . "
<br />
<div class='ipsLayout ipsLayout_withright ipsLayout_largeright'>
	<!--<div class='ipsLayout_right'>
		{$sideblocks['top']}
		" . ( method_exists( $this->registry->getClass('output')->getTemplate('gallery_albums'), 'miniAlbumStripHorizontal' ) ? $this->registry->getClass('output')->getTemplate('gallery_albums')->miniAlbumStripHorizontal($subAlbums, $childrenTitle, $album, $childrenRootCount) : '' ) . "
		{$sideblocks['bottom']}
		" . (($comments) ? ("
			<br />
			" . ( method_exists( $this->registry->getClass('output')->getTemplate('gallery_albums'), 'miniLatestCommentBlock' ) ? $this->registry->getClass('output')->getTemplate('gallery_albums')->miniLatestCommentBlock($comments, $this->lang->words['latest_commments']) : '' ) . "
		") : ("")) . "
	</div>-->
	
	<div class='ipsLayout_content'>
		<div class='ipsBox'>
			<div class='ipsBox_container ipsPad'>
				<a id=\"albumimages\"></a>
				" . ((count($recents)) ? ("<ul class='ipsList_inline ipsList_reset short wrap'>
						".$this->__f__d96767921e53b56127c28811a71e9d73($feature,$recents,$album,$children,$childrenTitle,$sideblocks,$comments,$childrenRootCount,$isUserView,$subAlbums)."					</ul>
					" . ((! empty( $album['_pages'] )) ? ("
						<div class='ipsPad'>{$album['_pages']}</div>
						<br />
					") : ("")) . "
					<br />") : ("")) . "
			</div>
		</div>
	</div>
	
</div>
<br />";
return $IPBHTML;
}


function __f__d96767921e53b56127c28811a71e9d73($feature, $recents, $album, $children, $childrenTitle, $sideblocks=array(), $comments='', $childrenRootCount=0, $isUserView=false, $subAlbums=array())
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $recents as $id => $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
							" . (($isUserView) ? ("
								<li class='ipsPad_half gallery_tiny_box' -data-id='{$id}'>
							") : ("
								<li class='ipsPad_half'>
							")) . "
								" . (($data['comments']) ? ("<div class='small'>{$data['comments']}</div>") : ("")) . "
								" . $this->registry->getClass('gallery')->inlineResize( $data['thumb'],'thumb_large','','' ) . "
								<div class='desc desc ipsType_smaller'>
									" . IPSText::truncate($data['caption'], 16) . "
									" . ((!$isUserView) ? ("
										<br />{$this->lang->words['album_ucfirst']}: <a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$data['album_id']}", "public",'' ), "{$data['album_name_seo']}", "viewalbum" ) . "'>{$data['album_name']}</a>
									") : ("")) . "
								</div>
							</li>
						
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- albumSelector --*/
function albumSelector($albums, $recents, $albumData=array()) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['albumSelector'] ) )
{
$count_cb6cd08b49b72054d3271e879bec605b = is_array($this->functionData['albumSelector']) ? count($this->functionData['albumSelector']) : 0;
$this->functionData['albumSelector'][$count_cb6cd08b49b72054d3271e879bec605b]['albums'] = $albums;
$this->functionData['albumSelector'][$count_cb6cd08b49b72054d3271e879bec605b]['recents'] = $recents;
$this->functionData['albumSelector'][$count_cb6cd08b49b72054d3271e879bec605b]['albumData'] = $albumData;
}
$IPBHTML .= "<h3>{$this->lang->words['as_title']}</h3>
<div class='fixed_inner ipsBox'>
	" . (($this->registry->output->isLargeTouchDevice()) ? ("
		<div class='message' style='margin-bottom: 5px;'>{$this->lang->words['scroll_tip']}</div>
	") : ("")) . "
	<div class='ipsVerticalTabbed ipsLayout ipsLayout_withleft ipsLayout_smallleft clearfix'>
		<div class='ipsVerticalTabbed_tabs ipsLayout_left'>
			<ul id='albumSelector_nav'>
				<li class='active'><a data-album-pane-update=\"albums=global\" href='#'>{$this->lang->words['as_global_albums']}</a></li>
				" . ((in_array( $this->request['type'], array( 'upload', 'createMembersAlbum', 'createAlbum', 'create' ) )) ? ("
					<li><a data-album-pane-update=\"albums=member&type={$this->request['type']}\" href='#'>{$this->lang->words['as_your_albums']}</a></li>
				") : ("")) . "" . (($albumData['album_id'] && ! $albumData['album_is_global'] && ( $this->request['moderate'] || IN_ACP )) ? ("<li><a data-album-pane-update=\"albums=othermember&member_id={$albumData['album_owner_id']}&type={$this->request['type']}\" href='#'>
					" . (($albumData['album_owner_id'] != $this->memberData['member_id']) ? ("{$albumData['owners_members_display_name']}'s Albums") : ("{$this->lang->words['as_your_albums']}")) . "
					</a></li>") : ("")) . "
				<li><a data-album-pane-update=\"albums=search&type={$this->request['type']}\" href='#'>{$this->lang->words['as_search_albums']}</a></li>
				<li><a data-album-pane-update=\"albums=recent&type={$this->request['type']}\" href='#'>{$this->lang->words['as_recent_albums']}</a></li>
			</ul>
		</div>
		<div class='ipsVerticalTabbed_content ipsLayout_content ipsBox_container' style='position: relative' id='albumSelector_content'>
			{$albums}
		</div>
	</div>
</div>";
return $IPBHTML;
}

/* -- albumSelectorPanel --*/
function albumSelectorPanel($albums, $filters, $navAlbums, $albumData) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['albumSelectorPanel'] ) )
{
$count_1d6568c1dff8402ff76f771808e820cf = is_array($this->functionData['albumSelectorPanel']) ? count($this->functionData['albumSelectorPanel']) : 0;
$this->functionData['albumSelectorPanel'][$count_1d6568c1dff8402ff76f771808e820cf]['albums'] = $albums;
$this->functionData['albumSelectorPanel'][$count_1d6568c1dff8402ff76f771808e820cf]['filters'] = $filters;
$this->functionData['albumSelectorPanel'][$count_1d6568c1dff8402ff76f771808e820cf]['navAlbums'] = $navAlbums;
$this->functionData['albumSelectorPanel'][$count_1d6568c1dff8402ff76f771808e820cf]['albumData'] = $albumData;
}
$IPBHTML .= "" . (($this->request['albums'] == 'search') ? ("<div class='ipsPad row2 ipsText_small desc ipsForm_center'>
	{$this->lang->words['filters_search']}
	<select id='searchType'>
		<option value='member' id='searchType_member' " . (($this->request['searchType']=='member') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_owners_name']}</option>
		<option value='album' id='searchType_album' " . (($this->request['searchType']=='album') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_albums_name']}</option>
		<option value='parent' id='searchType_parent' " . (($this->request['searchType']=='parent') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_albums_parent']}</option>
	</select>
	<select id='searchMatch'>
		<option value='is' " . (($this->request['searchMatch']=='is') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_is']}</option>
		<option value='contains' " . (($this->request['searchMatch']=='contains') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_contains']}</option>
	</select>
	<input type='text' size='20' class='input_text ipsText_small' id='searchText' value='{$_REQUEST['searchText']}' />
	<select id='searchIsGlobal'>
		<option value='0' id='searchIsGlobal_0' " . (($this->request['searchIsGlobal']=='0') ? ("selected='selected'") : ("")) . ">{$this->lang->words['as_search_member']}</option>
		<option value='1' id='searchIsGlobal_1' " . (($this->request['searchIsGlobal']=='1') ? ("selected='selected'") : ("")) . ">{$this->lang->words['as_search_global']}</option>
	</select>
	<select id='searchSort'>
		<option value='date' id='searchSort_date' " . (($this->request['searchSort']=='date') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_sort_upload']}</option>
		<option value='name' id='searchSort_name' " . (($this->request['searchSort']=='name') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_sort_name']}</option>
		<option value='images' id='searchSort_images' " . (($this->request['searchSort']=='images') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_sort_images']}</option>
		<option value='comments' id='searchSort_comments' " . (($this->request['searchSort']=='comments') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_sort_comments']}</option>
	</select>
	<select id='searchDir'>
		<option value='desc' id='searchDir_desc' " . (($this->request['searchDir']=='desc') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_desc']}</option>
		<option value='asc' id='searchDir_asc' " . (($this->request['searchDir']=='asc') ? ("selected='selected'") : ("")) . ">{$this->lang->words['filters_asc']}</option>
	</select>
	<input type='button' id='searchGo' value='{$this->lang->words['filters_update']}' class='ipsButton_secondary' />
</div>") : ("")) . "
" . (($navAlbums) ? ("
<div class=\"ipsPad\">
	".$this->__f__57c3206a39e5fb7bbe0346538953d1e7($albums,$filters,$navAlbums,$albumData)."</div>
") : ("")) . "
" . ((count($albums)) ? ("<table class='ipb_table'>
		" . (($this->request['type'] == 'createGlobalAlbum' || ($albumData['album_is_global'] && ( $this->request['moderate'] || IN_ACP ) && ( $this->request['type'] != 'moveImages' ))) ? ("
			<tr class='row2'>
				<td width='1%'>&nbsp;</td>
				<td>
					<strong>{$this->lang->words['as_root']}</strong>
					<div class='ipsType_small desc'>{$this->lang->words['as_select_root']}</div>
				</td>
				<td width='1%'>
					<input type='button' data-album-select-album-id=\"0\" class='ipsButton_secondary' value='{$this->lang->words['as_select']}' />
				</td>
			</tr>
		") : ("")) . "
		".$this->__f__984b5530dba2e3e6ac9de1a0d16cc680($albums,$filters,$navAlbums,$albumData)."	</table>") : ("
	<div class='ipsPad desc'>{$this->lang->words['as_no_albums_show']}</div>
")) . "
<script type=\"text/javascript\">
	ipb.gallery_albumChooser.setParam( 'type'     , '{$this->request['type']}' );
	ipb.gallery_albumChooser.setParam( 'albums'   , '" . (($isGlobal) ? ("global") : ("member")) . "' );
	ipb.gallery_albumChooser.setParam( 'moderate' , '{$this->request['moderate']}' );
	ipb.gallery_albumChooser.setParam( 'album_id' , '{$this->request['album_id']}' );
	ipb.gallery_albumChooser.setParam( 'member_id', '{$this->request['member_id']}' );
</script>";
return $IPBHTML;
}


function __f__57c3206a39e5fb7bbe0346538953d1e7($albums, $filters, $navAlbums, $albumData)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $navAlbums as $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
		<a href='#' class=\"ipsText_small desc\" data-album-pane-update=\"albums=search&searchType=parent&searchText={$data['album_id']}&searchisGlobal={$album['album_is_global']}\">{$data['album_name']}</a>
		" . ((!$data['_last']) ? ("
			<span class='ipsText_small desc'>&rarr;</span>
		") : ("")) . "
	
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__2a98cfa262941953aad123c840500006($albums, $filters, $navAlbums, $albumData,$id='',$album='')
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $album['_parents'] as $xid => $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
							<a class='ipsType_small desc' data-album-pane-update=\"albums=search&searchType=parent&searchText={$data['album_id']}&searchisGlobal={$album['album_is_global']}\" href='#'>{$data['album_name']}</a> <span class='ipsText_small desc'>&rarr;</span>
						
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__ec47acaec41e2594a1b5b1d57b5e20de($albums, $filters, $navAlbums, $albumData,$id='',$album='')
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $album['_children'] as $xid => $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
									<li>" . $this->registry->getClass('gallery')->inlineResize( $data['thumb'],'14','','' ) . " <a href='#' data-album-pane-update=\"albums=global&parent={$data['album_parent_id']}\">{$data['album_name']}</a></li>
								
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__984b5530dba2e3e6ac9de1a0d16cc680($albums, $filters, $navAlbums, $albumData)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $albums as $id => $album )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
			<tr " . (($album['album_id'] == $this->request['album_id']) ? ("class='row2'") : ("")) . ">
				<td width='1%'><div class='ipsUserPhoto'>" . $this->registry->getClass('gallery')->inlineResize( $album['thumb'],'30','','' ) . "</div></td>
				<td>
					" . (($album['_parents']) ? ("
						".$this->__f__2a98cfa262941953aad123c840500006($albums,$filters,$navAlbums,$albumData,$id,$album)."					") : ("")) . "
					<strong>{$album['album_name']}</strong>
					" . (($album['_children']) ? ("
						<div class='ipsPad'>
							<ul class='ipsList'>
								".$this->__f__ec47acaec41e2594a1b5b1d57b5e20de($albums,$filters,$navAlbums,$albumData,$id,$album)."							</ul>
						</div>
					") : ("")) . "
					" . ((! $album['album_is_global'] && ( $this->memberData['member_id'] != $album['album_owner_id'] )) ? ("
						<div class='ipsType_small desc'>{$this->lang->words['acp_albums_owners_name']} <a href='#'>{$album['owners_members_display_name']}</a></div>
					") : ("")) . "
					" . (($album['album_count_imgs']) ? ("
						<div class='ipsType_smaller desc lighter'>" . sprintf( $this->lang->words['as_images_comments'], $album['album_count_imgs'], $album['album_count_comments'] ) . " {$this->lang->words['as_last_upload']} " . $this->registry->getClass('class_localization')->getDate($album['album_last_img_date'],"tiny", 0) . "</div>
					") : ("")) . "
				</td>
				<td width='1%'>
					" . ((isset($album['_canUpload']) && ! $album['_canUpload']) ? ("
						&nbsp;
					") : ("
						<input type='button' data-album-select-album-id=\"{$album['album_id']}\" class='ipsButton_secondary' value='{$this->lang->words['as_select']}' />
					")) . "
				</td>
			</tr>
		
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- albumView --*/
function albumView($cover, $images, $album, $children, $parents, $follow='', $subAlbums='', $childrenRootCount) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['albumView'] ) )
{
$count_5fdfa1997df0cfa371de6c2766f00aa3 = is_array($this->functionData['albumView']) ? count($this->functionData['albumView']) : 0;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['cover'] = $cover;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['images'] = $images;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['album'] = $album;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['children'] = $children;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['parents'] = $parents;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['follow'] = $follow;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['subAlbums'] = $subAlbums;
$this->functionData['albumView'][$count_5fdfa1997df0cfa371de6c2766f00aa3]['childrenRootCount'] = $childrenRootCount;
}
$IPBHTML .= "<script type=\"text/javascript\">
 ipb.gallery.inSection = 'albumOverview';
 ipb.gallery.albumId   = parseInt({$album['album_id']});
 ipb.gallery.albumUrl  = \"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "\";
</script>
" . $this->registry->getClass('output')->addJSModule("gallery_albumchooser", "0" ) . "
" . (($follow) ? ("
	{$follow}
") : ("")) . "
{$cover['tag']}
<div class='ipsBox_withphoto'>
	" . ((! $this->registry->gallery->helper('albums')->isGlobal($album)) ? ("<span class='rating ipsType_smaller'>
			<strong>{$this->lang->words['rate_album']}</strong>&nbsp;&nbsp;
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=1&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_1' title='{$this->lang->words['rate_file_1']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 1) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=2&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_2' title='{$this->lang->words['rate_file_2']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 2) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=3&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_3' title='{$this->lang->words['rate_file_3']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 3) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=4&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_4' title='{$this->lang->words['rate_file_4']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 4) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=5&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_5' title='{$this->lang->words['rate_file_5']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 5) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			<span id='rating_text' class='desc'>
				" . (($album['album_rating_count'] > 0) ? ("{$album['album_rating_count']} {$this->lang->words['votes_cnt']}") : ("")) . "
				" . (($album['_youRated']) ? ("({$this->lang->words['you_voted']} {$album['_youRated']})") : ("")) . "
			</span>
			" . (($this->memberData['member_id']) ? ("<script type='text/javascript'>
					rating = new ipb.rating( 'album_rate_', { 
										url: 		'" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=ajax&amp;section=rate&amp;id={$album['album_id']}&where=album", "public",'' ), "", "" ) . "&md5check=' + ipb.vars['secure_hash'],
										cur_rating: " . intval($album['album_rating_aggregate']) . ",
										rated: 		" . (($album['album_rating_count']) ? ("1") : ("0")) . ",
										allow_rate: " . (($this->registry->gallery->helper('rate')->canRate($album) !== false && $this->memberData['member_id'] != $album['album_owner_id']) ? ("1") : ("0")) . "
									  } );
				</script>") : ("")) . "
		</span>") : ("")) . "
	<h1 class='ipsType_pagetitle'>
		" . (($this->registry->gallery->helper('albums')->isPrivate($album) === true) ? ("
			<span class='ipsBadge ipsBadge_red reset_cursor'>{$this->lang->words['private_ucfirst']}</span>
		") : ("")) . "
		{$album['album_name']}
	</h1>
	" . (($album['album_description'] || $album['album_g_rules_expanded']['text']) ? ("<div class='ipsType_pagedesc forum_rules'>
			" . (($album['album_g_rules_expanded']['text']) ? ("
				<strong>{$album['album_g_rules_expanded']['title']}</strong>
				{$album['album_g_rules_expanded']['text']}
			") : ("
				{$album['album_description']}
			")) . "
		</div>") : ("")) . "
</div>
<div class='topic_controls clear clearfix'>
	" . (($album['_pages']) ? ("
		{$album['_pages']}
	") : ("")) . "
	<ul class='topic_buttons'>
		" . (($this->registry->gallery->helper('albums')->isUploadable($album) || $this->registry->gallery->helper('albums')->canCreateSubAlbumInside($album)) ? ("
			<li><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=post&amp;section=image&amp;album_id={$album['album_id']}", "public",'' ), "", "" ) . "' title='{$this->lang->words['upload']}'>{$this->lang->words['upload']}</a></li>
		") : ("")) . "
		<li class='non_button'><a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=slideshow&amp;album={$album['album_id']}", "public",'' ), "", "" ) . "\">{$this->lang->words['ss_title']}</a></li>
	</ul>
</div>
<div class='ipsLayout ipsLayout_hugeright'>
	
	<div class='ipsLayout_right'>
	</div>
	
	<div class='ipsLayout_content'>
		<div class=''>
			<div class='ipsBox_container ipsPad'>
				" . ((is_array($images) && count($images)) ? ("
					<ul class='ipsList_inline ipsList_reset wrap'>
						".$this->__f__ada9f672e6583a5c7cc3331511337152($cover,$images,$album,$children,$parents,$follow,$subAlbums,$childrenRootCount)."					</ul>
				") : ("
					{$this->lang->words['category_no_images']}
				")) . "
			</div>
		</div>
		" . (($album['_pages']) ? ("
			<div class='ipsPad'>{$album['_pages']}</div>
			<br />
		") : ("")) . "
	</div>
	
</div>
<br class='clear' />
" . (($this->settings['sl_enable']) ? ("
	<div class='ipsPad'>
		" . IPSLib::shareLinks( $album['album_name'], array( 'skip' => array( 'print', 'download' ) ) ) . "
	</div>
	<br />
") : ("")) . "
" . (($album['_canModerate']) ? ("
	" . ( method_exists( $this->registry->getClass('output')->getTemplate('gallery_albums'), 'inlineAlbumModeration' ) ? $this->registry->getClass('output')->getTemplate('gallery_albums')->inlineAlbumModeration() : '' ) . "
") : ("")) . "";
return $IPBHTML;
}


function __f__ada9f672e6583a5c7cc3331511337152($cover, $images, $album, $children, $parents, $follow='', $subAlbums='', $childrenRootCount)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $images as $id => $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
							<li>
								" . (($album['_canModerate']) ? ("<input type=\"checkbox\" name=\"modBox_{$data['id']}\" id=\"modBox_{$data['id']}\" value=\"1\" class=\"albumModBox\" />") : ("")) . "
								" . (($data['comments']) ? ("<div class='small'>{$data['comments']}</div>") : ("")) . "
								" . $this->registry->getClass('gallery')->inlineResize( $data['thumb'],'thumb_large','','' ) . "
							</li>
						
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- albumViewDetail --*/
function albumViewDetail($cover, $images, $album, $children, $parents, $follow='', $subAlbums='', $childrenRootCount) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['albumViewDetail'] ) )
{
$count_8d39e0c5ce2d03b2f7617edbd0edcdbf = is_array($this->functionData['albumViewDetail']) ? count($this->functionData['albumViewDetail']) : 0;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['cover'] = $cover;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['images'] = $images;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['album'] = $album;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['children'] = $children;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['parents'] = $parents;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['follow'] = $follow;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['subAlbums'] = $subAlbums;
$this->functionData['albumViewDetail'][$count_8d39e0c5ce2d03b2f7617edbd0edcdbf]['childrenRootCount'] = $childrenRootCount;
}
$IPBHTML .= "<script type=\"text/javascript\">
 ipb.gallery.inSection = 'albumDetailView';
 ipb.gallery.albumId   = parseInt({$album['album_id']});
 ipb.gallery.albumUrl  = \"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "\";
</script>
" . $this->registry->getClass('output')->addJSModule("gallery_albumchooser", "0" ) . "
" . (($follow) ? ("
	{$follow}
") : ("")) . "
{$cover['tag']}
<div class='ipsBox_withphoto'>
	" . ((! $this->registry->gallery->helper('albums')->isGlobal($album)) ? ("<span class='rating ipsType_smaller'>
			<strong>{$this->lang->words['rate_album']}</strong>&nbsp;&nbsp;
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=1&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_1' title='{$this->lang->words['rate_file_1']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 1) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=2&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_2' title='{$this->lang->words['rate_file_2']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 2) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=3&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_3' title='{$this->lang->words['rate_file_3']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 3) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=4&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_4' title='{$this->lang->words['rate_file_4']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 4) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			" . (($this->memberData['member_id'] && $this->memberData['member_id'] != $album['album_owner_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=rate&amp;where=album&amp;id={$album['album_id']}&amp;rating=5&amp;secure_key={$this->member->form_hash}", "public",'' ), "", "" ) . "' id='album_rate_5' title='{$this->lang->words['rate_file_5']}'>") : ("")) . "" . (($album['album_rating_aggregate'] >= 5) ? ("<img src=\"{$this->settings['img_url']}/star.png\" alt='*' class='rate_img' />") : ("<img src=\"{$this->settings['img_url']}/star_off.png\" alt='*' class='rate_img' />")) . "" . (($this->memberData['member_id']) ? ("</a>") : ("")) . "
			<span id='rating_text' class='desc'>
				" . (($album['album_rating_count'] > 0) ? ("{$album['album_rating_count']} {$this->lang->words['votes_cnt']}") : ("")) . "
				" . (($album['_youRated']) ? ("({$this->lang->words['you_voted']} {$album['_youRated']})") : ("")) . "
			</span>
			" . (($this->memberData['member_id']) ? ("<script type='text/javascript'>
					rating = new ipb.rating( 'album_rate_', { 
										url: 		'" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=ajax&amp;section=rate&amp;id={$album['album_id']}&where=album", "public",'' ), "", "" ) . "&md5check=' + ipb.vars['secure_hash'],
										cur_rating: " . intval($album['album_rating_aggregate']) . ",
										rated: 		" . (($album['album_rating_count']) ? ("1") : ("0")) . ",
										allow_rate: " . (($this->registry->gallery->helper('rate')->canRate($album) !== false && $this->memberData['member_id'] != $album['album_owner_id']) ? ("1") : ("0")) . "
									  } );
				</script>") : ("")) . "
		</span>") : ("")) . "
	<h1 class='ipsType_pagetitle'>
		" . (($this->registry->gallery->helper('albums')->isPrivate($album) === true) ? ("
			<span class='ipsBadge ipsBadge_red reset_cursor'>{$this->lang->words['private_ucfirst']}</span>
		") : ("")) . "
		{$album['album_name']}
	</h1>
	" . (($album['album_description'] || $album['album_g_rules_expanded']['text']) ? ("<div class='ipsType_pagedesc forum_rules'>
			" . (($album['album_g_rules_expanded']['text']) ? ("
				<strong>{$album['album_g_rules_expanded']['title']}</strong>
				{$album['album_g_rules_expanded']['text']}
			") : ("
				{$album['album_description']}
			")) . "
		</div>") : ("")) . "
</div>
<div class='topic_controls clear'>
	" . ((! empty( $album['_pages'] )) ? ("
		{$album['_pages']}
	") : ("")) . "
	<ul class='topic_buttons'>
		" . (($this->registry->gallery->helper('albums')->isUploadable($album) || $this->registry->gallery->helper('albums')->canCreateSubAlbumInside($album)) ? ("
			<li><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=post&amp;section=image&amp;album_id={$album['album_id']}", "public",'' ), "", "" ) . "' title='{$this->lang->words['upload']}'>{$this->lang->words['upload']}</a></li>
		") : ("")) . "
		<li class='non_button'><a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=slideshow&amp;album={$album['album_id']}", "public",'' ), "", "" ) . "\">{$this->lang->words['ss_title']}</a></li>
		<li class='non_button'><a class='on' href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}&amp;display=overview", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "'>{$this->lang->words['overview_ucfirst']}</a></li>
	</ul>
</div>
<br />
" . ((array( $children ) && count( $children )) ? ("
	<h3 class=\"maintitle\">{$album['album_name']} {$this->lang->words['album_detail_subalbums']}</h3>
	<div class='ipsBox'>
		<div class='ipsBox_container'>
			<table class='ipb_table'>
				".$this->__f__817bbcb2ad865084d8dabd83a25dd392($cover,$images,$album,$children,$parents,$follow,$subAlbums,$childrenRootCount)."			</table>
		</div>
	</div>
	<br />
") : ("")) . "
<table class='ipb_table' id='albumDetailTable'>
	".$this->__f__7e3889a4b624a3e82590fbbfabcf0bfb($cover,$images,$album,$children,$parents,$follow,$subAlbums,$childrenRootCount)."	" . ((count( $images ) % 3) ? ("".$this->__f__de046bdecca136ddcd1928b6d4e3a1c9($cover,$images,$album,$children,$parents,$follow,$subAlbums,$childrenRootCount)."		</tr>
	") : ("")) . "
</table>
" . ((! empty( $album['_pages'] )) ? ("
	<div class='ipsPad'>{$album['_pages']}</div>
	<br />
") : ("")) . "
<br />
" . (($this->settings['sl_enable']) ? ("
	<div class='ipsPad'>
		" . IPSLib::shareLinks( $album['album_name'], array( 'skip' => array( 'print', 'download' ) ) ) . "
	</div>
	<br />
") : ("")) . "
" . (($album['_canModerate']) ? ("
	" . ( method_exists( $this->registry->getClass('output')->getTemplate('gallery_albums'), 'inlineAlbumModeration' ) ? $this->registry->getClass('output')->getTemplate('gallery_albums')->inlineAlbumModeration() : '' ) . "
") : ("")) . "";
return $IPBHTML;
}


function __f__be244be529d98f5240dce592a09cf959($cover, $images, $album, $children, $parents, $follow='', $subAlbums='', $childrenRootCount,$data='')
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( array(1,2,3,4,5) as $_rating )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
									" . (($data['album_rating_aggregate'] >= $_rating) ? ("" . $this->registry->getClass('output')->getReplacement("rate_on") . "") : ("" . $this->registry->getClass('output')->getReplacement("rate_off") . "")) . "
								
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__817bbcb2ad865084d8dabd83a25dd392($cover, $images, $album, $children, $parents, $follow='', $subAlbums='', $childrenRootCount)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $children as $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
					<tr>
						<td class='col_c_icon short altrow'>
							" . $this->registry->getClass('gallery')->inlineResize( $data['thumb'],'thumb_small','','' ) . "
						</td>
						<td>
							<span class='right'>
								".$this->__f__be244be529d98f5240dce592a09cf959($cover,$images,$album,$children,$parents,$follow,$subAlbums,$childrenRootCount,$data)."							</span>
							
							<h4>
								" . (($this->registry->gallery->helper('albums')->isGlobal($data)) ? ("
									<span class='ipsBadge ipsBadge_grey reset_cursor'>{$this->lang->words['global_album']}</span>
								") : ("")) . "
								<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$data['album_id']}", "public",'' ), "{$data['album_name_seo']}", "viewalbum" ) . "'>" . IPSText::truncate( $data['album_name'], 200) . "</a>
							</h4>
							" . (($data['album_description']) ? ("
								<div class='desc lighter blend_links'>
									" . IPSText::truncate( strip_tags( IPSText::getTextClass('bbcode')->stripAllTags( $data['album_description'] ), '<br />' ), 230 ) . "
								</div>
							") : ("")) . "
							" . (($data['_childrenCount']) ? ("
								<br class='clear' /><span class='right'><a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;browseAlbum={$data['album_id']}", "public",'' ), "{$data['album_name_seo']}", "browsealbum" ) . "\"><span class='ipsBadge ipsBadge_lightgrey reset_cursor'>" . sprintf( $this->lang->words['view_child_albums'], $data['_childrenCount'] ) . "</span></a></span>
							") : ("")) . "
						</td>
						<td class='col_f_views'>
							<ul>
								<li>" . $this->registry->getClass('class_localization')->formatNumber( $data['_totalImages'] ) . " {$this->lang->words['images_lower']}</li>
								<li class='views desc'>" . $this->registry->getClass('class_localization')->formatNumber( $data['_totalComments'] ) . " {$this->lang->words['comments_lower']}</li>
							</ul>
						</td>
						<td class='col_f_post'>
							" . ((!$this->registry->gallery->helper('albums')->isGlobal($data)) ? ("
								<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "showuser={$data['member']['member_id']}", "public",'' ), "{$data['member']['members_seo_name']}", "showuser" ) . "' class='ipsUserPhotoLink left'>
									<img src='{$data['member']['pp_small_photo']}' class='ipsUserPhoto ipsUserPhoto_mini' />
								</a>
								<ul class='last_post ipsType_small'>
									<li>" . ( method_exists( $this->registry->getClass('output')->getTemplate('global'), 'userHoverCard' ) ? $this->registry->getClass('output')->getTemplate('global')->userHoverCard($data['member']) : '' ) . "</li>
									<li>" . $this->registry->getClass('class_localization')->getDate($data['album_last_img_date'],"DATE", 0) . "</li>
								</ul>
							") : ("")) . "
						</td>
					</tr>
				
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__7e3889a4b624a3e82590fbbfabcf0bfb($cover, $images, $album, $children, $parents, $follow='', $subAlbums='', $childrenRootCount)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $images as $id => $image )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
		" . (($__iteratorCount == 1 OR $__iteratorCount + 1 % 3 == 0) ? ("
			<tr>
		") : ("")) . "
			<td class='ipsBox_container ipsPad" . ((!$image['approved']) ? (" moderated") : ("")) . "'>
				<h3>" . (($album['_canModerate']) ? ("<input type=\"checkbox\" name=\"modBox_{$image['id']}\" id=\"modBox_{$image['id']}\" value=\"1\" class=\"albumModBox right\" />") : ("")) . "{$image['caption']}</h3>
				<br />
				<div class='short'>{$image['_smallTag']}</div>
				<br />
				<div class='desc'>
					<p class='short'><em>" . (($image['_descriptionParsed']) ? ("{$image['_descriptionParsed']}") : ("&nbsp;")) . "</em></p>
					<br />
					{$this->lang->words['uploaded_ucfirst']}: " . $this->registry->getClass('class_localization')->getDate($image['idate'],"short", 0) . "
					" . (($image['member_id']) ? ("<br />{$this->lang->words['by_ucfirst']} " . ( method_exists( $this->registry->getClass('output')->getTemplate('global'), 'userHoverCard' ) ? $this->registry->getClass('output')->getTemplate('global')->userHoverCard(array('member_id' => $image['member_id'], 'members_display_name' => $image['members_display_name'], 'members_seo_name' => $image['members_seo_name'] )) : '' ) . "</strong> (<a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;user={$image['member_id']}", "public",'' ), "{$image['members_seo_name']}", "useralbum" ) . "\">{$this->lang->words['view_all_albums']}</a>)") : ("")) . "
					<br />" . intval($image['comments']) . " {$this->lang->words['comments_lower']} &middot; " . intval($image['views']) . " {$this->lang->words['views_lower']}
				</div>
			</td>
		" . (($__iteratorCount % 3 == 0) ? ("
			</tr>
		") : ("")) . "
	
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__de046bdecca136ddcd1928b6d4e3a1c9($cover, $images, $album, $children, $parents, $follow='', $subAlbums='', $childrenRootCount)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( array_fill( 0, 3 - ( count( $images ) % 3 ), '' ) as $foo )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
			<td class='ipsBox_container ipsPad'>&nbsp;</td>
		
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- boardIndexEntry --*/
function boardIndexEntry($album) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['boardIndexEntry'] ) )
{
$count_633bc04e3ca3825036afa6bf18dd5623 = is_array($this->functionData['boardIndexEntry']) ? count($this->functionData['boardIndexEntry']) : 0;
$this->functionData['boardIndexEntry'][$count_633bc04e3ca3825036afa6bf18dd5623]['album'] = $album;
}

if ( $this->registry->gallery->helper('albums')->isContainerOnly( $album ) OR $this->registry->gallery->helper('albums')->isGlobal( $album ) )
	{
		$children     = $this->registry->gallery->helper('albums')->fetchAlbumChildren( $album['album_id'], array( 'isViewable' => true, 'limit' => 50, 'sortKey' => 'date', 'sortOrder' => 'desc' ) );
		$this->_recentImages[ $album['album_id'] ] = $this->registry->gallery->helper('image')->fetchImages( $this->memberData['member_id'], array( 'albumId' => array_keys( $children ), 'limit' => 8, 'sortKey' => 'date', 'sortOrder' => 'desc' ) );
	}
$IPBHTML .= "<style type=\"text/css\">
.inlineimage img {
	float: right;
	width: 30px;
	height: 30px;
	padding-left: 5px;
}
</style><tr class='" .  IPSLib::next( $this->registry->templateStriping["catTable"] ) . "'>
	<td class='altrow' align='center'>
		" . $this->registry->getClass('gallery')->inlineResize( $album['thumb'],'30','','' ) . "
	</td>
	<td>
		<h4><a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "\">{$this->lang->words['album_ucfirst']} {$album['album_name']}</a></h4>
		<p class='desc'>{$album['album_description']}</p>
	</td>
	" . (($this->registry->gallery->helper('albums')->isContainerOnly( $album ) OR $this->registry->gallery->helper('albums')->isGlobal( $album )) ? ("<td class='altrow stats' colspan=\"2\" style='overflow:hidden'>
		" . ((is_array( $this->_recentImages[ $album['album_id'] ] ) && count($this->_recentImages[ $album['album_id'] ])) ? ("".$this->__f__b49442e561ac2a6e2bc9534abce6ba47($album)."		") : ("")) . "
		</td>") : ("<td class='altrow stats'>
		<ul>
			<li>{$album['album_count_imgs']} {$this->lang->words['images_lower']}</li>
			<li>{$album['album_count_comments']} {$this->lang->words['comments_lower']}</li>
		</ul>
	</td>
	<td>
		<ul class='last_post'>
			" . (($album['album_last_img_date']) ? ("
				<li>" . $this->registry->getClass('class_localization')->getDate($album['album_last_img_date'],"LONG", 0) . "</li>
			") : ("")) . "
		</ul>
	</td>")) . "
</tr>";
return $IPBHTML;
}


function __f__b49442e561ac2a6e2bc9534abce6ba47($album)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $this->_recentImages[ $album['album_id'] ] as $id => $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
				<div class='inlineimage'>" . $this->registry->getClass('gallery')->inlineResize( $data['thumb'],'thumb_tiny','','' ) . "</div>
			
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- deleteAlbumDialogue --*/
function deleteAlbumDialogue($data=array(), $hasKids=false) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['deleteAlbumDialogue'] ) )
{
$count_5aa0dd7bc953259336c85db43a71374a = is_array($this->functionData['deleteAlbumDialogue']) ? count($this->functionData['deleteAlbumDialogue']) : 0;
$this->functionData['deleteAlbumDialogue'][$count_5aa0dd7bc953259336c85db43a71374a]['data'] = $data;
$this->functionData['deleteAlbumDialogue'][$count_5aa0dd7bc953259336c85db43a71374a]['hasKids'] = $hasKids;
}
$IPBHTML .= "" . (($hasKids) ? ("
	<h3>{$this->lang->words['delete_album']}</h3>
	<div class='pad center'>
	 {$this->lang->words['mod_alb_del_not_able_children']}
	</div>
") : ("<form action=\"{$this->settings['base_url']}app=gallery&module=albums&section=album&amp;do=delete&amp;album={$data['album_id']}\" method=\"post\" id=\"albumDeleteForm_{$data['album_id']}\">
	<input type='hidden' name='auth_key' value='{$this->member->form_hash}' />
	{$data['hiddens']}
	{$data['errors']}
	
	<h3>{$this->lang->words['delete_album']}</h3>
	<div class='ipsBox short'>
	 {$this->lang->words['mod_alb_del_title']}
	 " . (($data['options'] !== false) ? ("
	 	<div style=\"width:auto; display:inline-block; margin: 0 auto; text-align: left;\" class='ipsPad'>
	 	 	<input type=\"radio\" name=\"doDelete\" value=\"0\" checked=\"checked\" /> {$this->lang->words['mod_alb_del_move']}
		 	<select name='move_to_album_id' id='move_to_album_id' class='input_select'>
				{$data['options']}
			</select>
			<br />
			<input type=\"radio\" name=\"doDelete\" value=\"1\" /> {$this->lang->words['mod_alb_del_desc']}
		</div>
	 ") : ("
	 	<input type=\"hidden\" name=\"doDelete\" value=\"1\" />
	 ")) . "
	 <br /><br />
	 <input type='submit' class=\"input_submit\" value=\"{$this->lang->words['mod_alb_del_go']}\" />
	</div>
</form>")) . "";
return $IPBHTML;
}

/* -- galleryPhotoAlbum --*/
function galleryPhotoAlbum($albumImages, $albumID) {
$IPBHTML = "";
$IPBHTML .= "<fieldset class='row1'>
		<h3>{$this->lang->words['profile_photo_album']}</h3>
		
		".$this->__f__4ca5b5fc5523043887e00e43007b6a95($albumImages,$albumID)."		<p>&nbsp;</p>
		<p align='right'><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=user&amp;user={$this->memberData['member_id']}&amp;do=view_album&amp;album={$albumID}", "public",'' ), "", "" ) . "'>{$this->lang->words['profile_photo_view_album']}</a></p>
	</fieldset>";
return $IPBHTML;
}


function __f__4ca5b5fc5523043887e00e43007b6a95($albumImages, $albumID)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $albumImages as $r )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
			<div class='avatar_gallery'>
				<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=images&amp;section=profilephoto&amp;id={$r['id']}&amp;return=usercp", "public",'' ), "", "" ) . "' title='{$this->lang->words['profile_photo_thumb_title']}'><img src=\"{$r['_image']}\" alt=\"\" /></a>
			</div>
		
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- inlineAlbumModeration --*/
function inlineAlbumModeration() {
$IPBHTML = "";
$IPBHTML .= "<script type='text/javascript'>
	albumSelectorUpdate = '{\"field\": \"albumModBox_moveTo\",\"div\": \"asDiv\"}';
	ipb.templates['album_moderation'] = new Template(\"<div id='album_moderate_box' class='ipsFloatingAction' style='display: none'><span class='desc'>{$this->lang->words['album_modaction_count']} </span><select name='modOptions' id='albumModAction' class='input_select'><option value='approve'>{$this->lang->words['mod_img_approve']}</option><option value='unapprove'>{$this->lang->words['mod_img_unapprove']}</option><option value='delete'>{$this->lang->words['mod_img_delete']}</option><option value='move'>{$this->lang->words['mod_img_move']}</option></select>&nbsp;&nbsp;<input type='button' class='input_submit' id='submitModAction' value='{$this->lang->words['jmp_go']}' /><div id='albumModBox_move' class='desc ipsPad_half short' style='display:none'></div><div class='desc ipsPad_half short'><input type='checkbox' name='albumModSelectAll' id='albumModSelectAll' value='1' #{checked} /> <label for='albumModSelectAll'>{$this->lang->words['mod_select_all']}</label></p></div>\");
	ipb.templates['album_img_moveto'] = new Template(\"{$this->lang->words['album_modaction_moveto']}: <input type='hidden' id='albumModBox_moveTo' value=0 /><div style='display:none' class='albumSelected' id='asDiv'></div><a class='ipsButton_secondary' data-album-selector-auto-update='\" + albumSelectorUpdate + \"' data-album-selector='type=moveImages&moderate=1&album_id=#{album_id}'>{$this->lang->words['as_select_album']}</a>\");
</script>";
return $IPBHTML;
}

/* -- miniAlbumStripHorizontal --*/
function miniAlbumStripHorizontal($albums, $title='', $parent=array(), $beforeTrimCount=0) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['miniAlbumStripHorizontal'] ) )
{
$count_8dd8c405e253d85217aefe2f0a255e07 = is_array($this->functionData['miniAlbumStripHorizontal']) ? count($this->functionData['miniAlbumStripHorizontal']) : 0;
$this->functionData['miniAlbumStripHorizontal'][$count_8dd8c405e253d85217aefe2f0a255e07]['albums'] = $albums;
$this->functionData['miniAlbumStripHorizontal'][$count_8dd8c405e253d85217aefe2f0a255e07]['title'] = $title;
$this->functionData['miniAlbumStripHorizontal'][$count_8dd8c405e253d85217aefe2f0a255e07]['parent'] = $parent;
$this->functionData['miniAlbumStripHorizontal'][$count_8dd8c405e253d85217aefe2f0a255e07]['beforeTrimCount'] = $beforeTrimCount;
}

if ( ! isset( $this->registry->templateStriping['gallglobal'] ) ) {
$this->registry->templateStriping['gallglobal'] = array( FALSE, "row1","row2");
}
$IPBHTML .= "<div class='general_box'>
	" . (($title) ? ("<h3>{$title}</h3>") : ("")) . "
	" . ((! count( $albums ) OR ! is_array( $albums )) ? ("
		<div class='ipsPad'>{$this->lang->words['albums_none_to_see']}</div>
	") : ("<ul>
			".$this->__f__79399a3ce4626f708d614a002bdc6943($albums,$title,$parent,$beforeTrimCount)."			" . (($beforeTrimCount && ( $beforeTrimCount > count( $albums ) )) ? ("
				<li class='" .  IPSLib::next( $this->registry->templateStriping["gallglobal"] ) . " desc showMore clear ipsPad'>
					<a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;browseAlbum={$parent['album_id']}", "public",'' ), "{$parent['album_name_seo']}", "browsealbum" ) . "\">{$this->lang->words['show_all_dots']}</a>
				</li>
			") : ("")) . "
		</ul>")) . "
</div>";
return $IPBHTML;
}


function __f__5855f35473f0f7f8e931b7cce24b3a86($albums, $title='', $parent=array(), $beforeTrimCount=0,$i='',$album='')
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $album['_latestImages'] as $id => $img )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
									" . $this->registry->getClass('gallery')->inlineResize( $img['thumb'],'teeny','','ipsUserPhoto' ) . "
								
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__79399a3ce4626f708d614a002bdc6943($albums, $title='', $parent=array(), $beforeTrimCount=0)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $albums as $i => $album )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
				<li class='" .  IPSLib::next( $this->registry->templateStriping["gallglobal"] ) . " clear'>
					<div class='album horizontal'>
						" . $this->registry->getClass('gallery')->inlineResize( $album['thumb'],'thumb_small','','' ) . "
						<p>
							" . (($this->registry->gallery->helper('albums')->isPrivate($album)) ? ("
								<span class='ipsBadge ipsBadge_red reset_cursor'>{$this->lang->words['private_ucfirst']}</span>
							") : ("")) . "
							<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "'>{$album['album_name']}</a>
						</p>
						" . ((is_array($album['_children']) && count($album['_children'])) ? ("
							" . ( method_exists( $this->registry->getClass('output')->getTemplate('gallery_albums'), 'miniAlbumStripSubAlbums' ) ? $this->registry->getClass('output')->getTemplate('gallery_albums')->miniAlbumStripSubAlbums($album['_children'], $album) : '' ) . "
						") : ("")) . "
						" . (($album['album_is_global']) ? ("" . ((is_array( $album['_latestImages'] )) ? ("<ol class='ipsList_inline ipsType_small' style='margin-left:76px'>
								".$this->__f__5855f35473f0f7f8e931b7cce24b3a86($albums,$title,$parent,$beforeTrimCount,$i,$album)."								</ol>
								" . ((is_array($album['_children']) && count($album['_children'])) ? ("
									<br class='clear' /><br />
								") : ("")) . "") : ("")) . "") : ("" . (($album['album_count_imgs']) ? ("
								<br />
								<div class='ipsType_small desc'>
								" . intval($album['album_count_imgs']) . " {$this->lang->words['total_images']}
								<br />{$this->lang->words['last_ucfirst']}: " . $this->registry->getClass('class_localization')->getDate($album['album_last_img_date'],"short", 0) . "
								</div>
							") : ("")) . "")) . "
					</div>
				</li>
			
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- miniAlbumStripSubAlbums --*/
function miniAlbumStripSubAlbums($albums, $parent) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['miniAlbumStripSubAlbums'] ) )
{
$count_4470b8ae09cb52b0793c19add241a55c = is_array($this->functionData['miniAlbumStripSubAlbums']) ? count($this->functionData['miniAlbumStripSubAlbums']) : 0;
$this->functionData['miniAlbumStripSubAlbums'][$count_4470b8ae09cb52b0793c19add241a55c]['albums'] = $albums;
$this->functionData['miniAlbumStripSubAlbums'][$count_4470b8ae09cb52b0793c19add241a55c]['parent'] = $parent;
}

$count         = count( $albums );
$this->_lang   = '';
if ( $count > 5 )
{
	$albums      = array_slice( $albums, 0, 5, true );
	$this->_lang = sprintf( $this->lang->words['gal_and_n_more'], ( $count - 5 ) );
}
$ids           = array_keys( $albums );
$this->_lastId = array_pop( $ids );
$IPBHTML .= "<ol class='ipsList_inline ipsType_small sub_albums' id='subalbums_{$parent['album_id']}'>
	".$this->__f__4d927de72aaff71f19469e4214f5b859($albums,$parent)."</ol>";
return $IPBHTML;
}


function __f__4d927de72aaff71f19469e4214f5b859($albums, $parent)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $albums as $id => $album )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
		<li>
			<a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "\">{$album['album_name']}</a>" . (($album['album_id'] != $this->_lastId) ? (",") : ("")) . "
		</li>
		" . (($this->_lang && ($album['album_id'] == $this->_lastId )) ? ("
			<li><a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$parent['album_id']}", "public",'' ), "{$parent['album_name_seo']}", "viewalbum" ) . "\">{$this->_lang}</a></li>
		") : ("")) . "
	
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- miniLatestCommentBlock --*/
function miniLatestCommentBlock($images, $title='') {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['miniLatestCommentBlock'] ) )
{
$count_e6c297c058b8d76ba69a5f3f8cf07caa = is_array($this->functionData['miniLatestCommentBlock']) ? count($this->functionData['miniLatestCommentBlock']) : 0;
$this->functionData['miniLatestCommentBlock'][$count_e6c297c058b8d76ba69a5f3f8cf07caa]['images'] = $images;
$this->functionData['miniLatestCommentBlock'][$count_e6c297c058b8d76ba69a5f3f8cf07caa]['title'] = $title;
}

if ( ! isset( $this->registry->templateStriping['recentComments'] ) ) {
$this->registry->templateStriping['recentComments'] = array( FALSE, "row1","row2");
}
$IPBHTML .= "<div class='general_box'>
	" . (($title) ? ("<h3>{$title}</h3>") : ("")) . "
	
	<ul class='ipsList_withmediumphoto ipsPad_half'>
		".$this->__f__e0b1bcf5e208a69dd8daf49e20547818($images,$title)."	</ul>
</div>";
return $IPBHTML;
}


function __f__e0b1bcf5e208a69dd8daf49e20547818($images, $title='')
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $images as $i => $image )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
			<li class='" .  IPSLib::next( $this->registry->templateStriping["recentComments"] ) . " clear ipsPad_half'>
				<span class='left' data-tooltip=\"{$image['_commentShort']}\">" . $this->registry->getClass('gallery')->inlineResize( $image['thumb'],'thumb_small','','ipsUserPhoto' ) . "</span>
				<div class='list_content ipsPad_left'>
					<strong><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;image={$image['id']}", "public",'' ), "{$image['caption_seo']}", "viewimage" ) . "'>{$image['caption']}</a></strong>
					<br />
					<div class='ipsPad_top_bottom_half desc'>
						{$image['_commentShort']}
					</div>
					<div class='ipsType_small lighter blendlinks desc'>
						" . (($image['_commentAuthor']) ? ("" . ( method_exists( $this->registry->getClass('output')->getTemplate('global'), 'userHoverCard' ) ? $this->registry->getClass('output')->getTemplate('global')->userHoverCard($image['_commentAuthor']) : '' ) . " {$this->lang->words['on']} ") : ("")) . "" . $this->registry->getClass('class_localization')->getDate($image['lastcomment'],"short", 0) . "
					</div>
				</div>
			</li>
		
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- newAlbumDialogue --*/
function newAlbumDialogue($data=array()) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['newAlbumDialogue'] ) )
{
$count_63129b2016e003e23b1df0172932cf1c = is_array($this->functionData['newAlbumDialogue']) ? count($this->functionData['newAlbumDialogue']) : 0;
$this->functionData['newAlbumDialogue'][$count_63129b2016e003e23b1df0172932cf1c]['data'] = $data;
}
$IPBHTML .= "<form action=\"{$this->settings['base_url']}\" method=\"post\" name=\"theForm\">
	<input type=\"hidden\" name=\"app\" value=\"core\" />
	<input type=\"hidden\" name=\"module\" value=\"usercp\" />
	<input type=\"hidden\" name=\"tab\" value=\"gallery\" />
	<input type=\"hidden\" name=\"area\" value=\"albums\" />
	<input type=\"hidden\" name=\"do\" value=\"{$data['type_op']}\" />
	<input type='hidden' name='auth_key' value='{$this->member->form_hash}' />
	{$data['hiddens']}
	{$data['errors']}
	
	<h3>{$this->lang->words['new_album']}</h3>
	<fieldset class='row1'>
		<ul>
			<li class='field'>
				<label for='name'>{$this->lang->words['album_name']}</label>
				<input type=\"text\" size=\"40\" maxlength=\"60\" name=\"album_name\" id='album_name' value=\"{$data['album_name']}\" class='input_text' />
			</li>
			<li class='field'>
				<label for='desc'>{$this->lang->words['album_desc']}</label>
				<textarea name='album_description' rows='5' cols='60' style='width:95%' id='album_description' class='input_text'>{$data['album_description']}</textarea>
			</li>
			<li class='field'>
				<label for='parent'>{$this->lang->words['parent_album']}</label>
				<input type='hidden' id='album_parent_id' name='album_parent_id' value='{$data['_parent']['album_id']}' /><div class='albumSelected' id='asDiv'>{$data['_parent']['album_name']}</div>
				<a href='#' class='ipsButton_secondary' data-album-selector-auto-update='{\"field\": \"album_parent_id\", \"div\": \"asDiv\"}' data-album-selector='type=createMembersAlbum&album_id={$data['_parent']['album_id']}'>{$this->lang->words['as_select_album']}</a>
			</li>
			<li class='field'>
				<select name=\"album_sort_options__key\" id='album_sort_options__key'>
					".$this->__f__36754520fb88d0dd7cd69c80f4818e88($data)."				</select>
				<select name=\"album_sort_options__dir\" id='album_sort_options__dir'>
					".$this->__f__39cefb40b1b1865c79edb690cd21714c($data)."				</select>
			</li>
			" . (($this->memberData['g_album_private']) ? ("<li class='field checkbox'>
				<input type=\"radio\" name=\"album_is_public\" id='album_is_profile' value=\"0\" class='input_check' " . (($data['album_is_profile']) ? ("checked='checked'") : ("")) . " />
				<label for='album_is_profile'>{$this->lang->words['private_album']}</label>
				<span class='desc'>{$this->lang->words['new_alb_prv_desc']}</span>
			</li>") : ("")) . "
			<li class='field checkbox'>
				<input type=\"radio\" name=\"album_is_public\" id='album_is_public' value=\"1\" class='input_check' " . (($data['album_is_public'] == 1) ? ("checked='checked'") : ("")) . " />
				<label for='album_is_public'>{$this->lang->words['album_public_frm']}</label>
				<span class='desc'>{$this->lang->words['album_public_chk']}</span>
			</li>
			<li class='field checkbox'>
				<input type=\"radio\" name=\"album_is_public\" id='album_is_friends' value=\"2\" class='input_check' " . (($data['album_is_public'] == 2) ? ("checked='checked'") : ("")) . " />
				<label for='album_is_friends'>{$this->lang->words['album_friend_only_frm']}</label>
				<span class='desc'>{$this->lang->words['album_friend_only_chk']}</span>
			</li>
			<li class='field checkbox'>
				<input type='checkbox' value='1' class='input_check' name='album_detail_default' id='album_detail_default' />
				<label for='album_detail_default'>{$this->lang->words['album_detail_default']}</label>
				<span class='desc'>{$this->lang->words['album_detail_default_frm']}</span>
			</li>
			<li class='field checkbox' id='parentAlbumWatermark' style='display:none;'>
				<input type='checkbox' value='1' class='input_check' name='album_watermark' id='album_watermark' />
				<label for='album_watermark'>{$this->lang->words['album_watermark_check']}</label>
				<span class='desc'>{$this->lang->words['album_watermark_check_desc']}</span>
			</li>
		</ul>
	</fieldset>
	<fieldset class='submit' id='fieldset_aSubmit'>
		<input type='submit' value=\"{$this->lang->words['save_ucfirst']}\" class='input_submit _aSubmit' /> {$this->lang->words['or']} <a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=core&amp;module=usercp&amp;tab=gallery", "public",'' ), "", "" ) . "' title='{$this->lang->words['cancel']}' class='cancel'>{$this->lang->words['cancel']}</a>
	</fieldset>
</form>";
return $IPBHTML;
}


function __f__36754520fb88d0dd7cd69c80f4818e88($data=array())
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( array('idate','views','comments','rating', 'name' ) as $field )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
						<option value=\"{$field}\" " . (($album['album_sort_options__key'] == 'idate') ? ("selected='selected'") : ("")) . ">{$this->lang->words['album_sort_'.$field]}</option>
					
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__39cefb40b1b1865c79edb690cd21714c($data=array())
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( array('asc', 'desc' ) as $field )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
						<option value=\"{$field}\" " . (($album['album_sort_options__dir'] == 'asc') ? ("selected='selected'") : ("")) . ">{$this->lang->words['album_sort_'.$field]}</option>
					
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- slideShow --*/
function slideShow($album, $imageIds, $imageData, $lastID) {
$IPBHTML = "";
$IPBHTML .= "" . $this->registry->getClass('output')->addJSModule("slideshow", "0" ) . "
<script type='text/javascript'>
	/* URL to full-size images */
" . (($this->settings['gallery_web_accessible'] == 'yes') ? ("
	ipb.slideshow.imageURL = \"{$this->settings['gallery_images_url']}/\";
") : ("
	ipb.slideshow.imageURL = \"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&module=images&section=img_ctrl", "public",'' ), "", "" ) . "\";
")) . "
	/* The image ID's in order to be displayed */
	var IMAGES = [ $imageIds ];
	/* Array of image data, order doesn't matter. Key is image ID to match above array */
	var IMAGE_DATA = \$H({".$this->__f__1fbd04436a6e9cc1a08cfde64422d8d5($album,$imageIds,$imageData,$lastID)."						});
	/* URL to where user photos will be */
	ipb.slideshow.userPhotoURL = \"\";
	/* Just templates */
	ipb.slideshow.userInfo = new Template(\"<div id='info_#{id}' class='info' style='display: none'><img src='#{photo}' width='#{width}' height='#{height}' class='photo' /><div class='info_body'><h1>#{title}</h1><h2>{$this->lang->words['by_ucfirst']} #{name}</h2></div>\");
	ipb.slideshow.thumbnail = new Template(\"<div id='thumb_#{id}' class='thumb'></div>\");
</script>
<div id='slideshow'>
	
	<div id='image_info'></div>
	<div id='thumbnail_bar'>
		<div id='thumbnails'>
			<div id='thumbnail_wrap'></div>
		</div>
		<div id='button_left'></div>
		<div id='button_right'></div>
	</div>
	<div id='image_holder'></div>
	<div id='slideshow_controls'>
		<div id='controls'><a href='#' id='c_PREV' class='control' title='{$this->lang->words['previous_image']}'>&nsbp;</a><a href='#' id='c_PAUSE_PLAY' class='control' title='{$this->lang->words['ss_playpause']}'>&nsbp;</a><a href='#' id='c_NEXT' class='control' title='{$this->lang->words['ss_next_img']}'>&nsbp;</a></div>
		<div id='loading'></div>
	</div>
	<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$album['album_id']}", "public",'' ), "{$album['album_name_seo']}", "viewalbum" ) . "' id='close_slideshow'>{$this->lang->words['ss_back']}</a>
</div>
<div style='display: none'>
	<img src='{$this->settings['img_url']}/gallery/slideshow/next.png' />
	<img src='{$this->settings['img_url']}/gallery/slideshow/next_hover.png' />
	<img src='{$this->settings['img_url']}/gallery/slideshow/prev.png' />
	<img src='{$this->settings['img_url']}/gallery/slideshow/prev_hover.png' />
	<img src='{$this->settings['img_url']}/gallery/slideshow/pause.png' />
	<img src='{$this->settings['img_url']}/gallery/slideshow/play.png' />
	<img src='{$this->settings['img_url']}/gallery/slideshow/pause_hover.png' />
	<img src='{$this->settings['img_url']}/gallery/slideshow/play_hover.png' />
</div>";
return $IPBHTML;
}


function __f__1fbd04436a6e9cc1a08cfde64422d8d5($album, $imageIds, $imageData, $lastID)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $imageData as $r )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
						{$r['id']}: { 	
										'title': '{$r['caption']}',
" . (($this->settings['gallery_web_accessible'] == 'yes') ? ("
						 				'filename': '{$r['directory']}/{$r['masked_file_name']}',
										'thumb': '{$r['directory']}/tn_{$r['masked_file_name']}',
") : ("
										'filename': '&img={$r['id']}',
										'thumb': '&img={$r['id']}&tn=1',
")) . "
										'author': {
													'id': {$r['member_id']},
													'name': '{$r['members_display_name']}',
													'photo': '{$r['_photo']['pp_small_photo']}',
													'width': '{$r['_photo']['pp_small_width']}',
													'height': '{$r['_photo']['pp_small_height']}'
												}
									}" . (($lastID != $r['id']) ? (",") : ("")) . "

";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- userCpAlbumIndexView --*/
function userCpAlbumIndexView($rows="") {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_gallery_albums', $this->_funcHooks['userCpAlbumIndexView'] ) )
{
$count_9006cec13afb94a3218ed16fd5f0c05c = is_array($this->functionData['userCpAlbumIndexView']) ? count($this->functionData['userCpAlbumIndexView']) : 0;
$this->functionData['userCpAlbumIndexView'][$count_9006cec13afb94a3218ed16fd5f0c05c]['rows'] = $rows;
}

if ( ! isset( $this->registry->templateStriping['albums'] ) ) {
$this->registry->templateStriping['albums'] = array( FALSE, "row2","row1");
}
$IPBHTML .= "" . ( method_exists( $this->registry->getClass('output')->getTemplate('gallery_global'), 'galleryCss' ) ? $this->registry->getClass('output')->getTemplate('gallery_global')->galleryCss() : '' ) . "
" . (($this->registry->gallery->helper('albums')->canCreate()) ? ("
	<ul class='topic_buttons'>
		<li><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=post&amp;section=image", "public",'' ), "", "" ) . "'>{$this->lang->words['container_noup_title']}</a></li>
	</ul>
") : ("")) . "
<h3 class='ipsType_subtitle ipsSettings_pagetitle'>{$this->lang->words['your_albums']}</h3>
<br class='clear' />
<fieldset class='row1'>
	" . ((count( $rows )) ? ("
		" . $this->registry->getClass('output')->addJSModule("gallery", "0" ) . "
		<table class='ipb_table'>
						".$this->__f__d47a3fea1cccb3089027035a20e9cb7c($rows)."		</table>
	") : ("
		<p class='no_messages'>{$this->lang->words['no_album']}</p>
	")) . "
</fieldset>";
return $IPBHTML;
}


function __f__d47a3fea1cccb3089027035a20e9cb7c($rows="")
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $rows as $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
				<tr class='" .  IPSLib::next( $this->registry->templateStriping["albums"] ) . "'>
					<td class='col_c_icon'>" . $this->registry->getClass('gallery')->inlineResize( $data['thumb'],'thumb_small','','' ) . "</td>
					<td>
						" . (($this->registry->gallery->helper('albums')->isUploadable($data) || $this->registry->gallery->helper('albums')->isOwner($data) || $this->registry->gallery->helper('albums')->canModerate($data)) ? ("<ul class='ipsList_inline right'>
								" . (($this->registry->gallery->helper('albums')->canEdit($data)) ? ("
									<li><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;module=post&amp;section=image&amp;album_id={$data['album_id']}", "public",'' ), "", "" ) . "' title='{$this->lang->words['upload']}' class='ipsButton_secondary'>" . $this->registry->getClass('output')->getReplacement("gallery_image") . "</a></li>
								") : ("")) . "
								" . (($this->registry->gallery->helper('albums')->isUploadable($data)) ? ("
									<li><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;albumedit={$data['album_id']}", "public",'' ), "{$data['album_name_seo']}", "editalbum" ) . "' class='ipsButton_secondary' title='{$this->lang->words['edit']}'>" . $this->registry->getClass('output')->getReplacement("galery_album_edit") . "</a></li>
								") : ("")) . "
								" . (($this->registry->gallery->helper('albums')->canDelete($data)) ? ("
									<li><a href=\"javascript:void(0);\" album-id=\"{$data['album_id']}\" class=\"ipsButton_secondary _albumDelete\" title='{$this->lang->words['delete_link']}'>" . $this->registry->getClass('output')->getReplacement("gallery_album_delete") . "</a></li>
								") : ("")) . "
							</ul>") : ("")) . "
						" . (($this->registry->gallery->helper('albums')->isFriends($data)) ? ("
							<span class='ipsBadge ipsBadge_green reset_cursor' data-tooltip='{$this->lang->words['friend_only_prefix_desc']}' title='{$this->lang->words['friend_only_prefix_desc']}'>{$this->lang->words['friend_only_prefix']}</span>&nbsp;
						") : ("")) . "
						" . (($this->memberData['g_album_private'] && $this->registry->gallery->helper('albums')->isPrivate($data)) ? ("
							<span class='ipsBadge ipsBadge_red reset_cursor'>{$this->lang->words['private_ucfirst']}</span>&nbsp;
						") : ("")) . "
						<strong>{$data['depthString']}<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=gallery&amp;album={$data['album_id']}", "public",'' ), "{$data['album_name_seo']}", "viewalbum" ) . "'>{$data['album_name']}</a></strong>
						
						" . (($data['album_description']) ? ("
							<div class='album_desc'>
								" . IPSText::truncate( strip_tags( IPSText::getTextClass('bbcode')->stripAllTags( $data['album_description'] ), '<br />' ), 200 ) . "
							</div>
						") : ("")) . "
					</td>
					<td class='col_c_post desc'>
						<strong>{$data['album_count_imgs']}" . (($data['mod_images']) ? (" <em class='moderated inline-moderated'>(+ {$data['mod_images']} {$this->lang->words['queued_suffix']})</em>") : ("")) . "</strong> {$this->lang->words['images']}<br />
						<strong>{$data['album_count_comments']}" . (($data['mod_comments']) ? (" <em class='moderated inline-moderated'>(+ {$data['mod_comments']} {$this->lang->words['queued_suffix']})</em>") : ("")) . "</strong> {$this->lang->words['comments']}
						" . (($this->registry->gallery->helper('albums')->isUploadable($data)) ? ("
							<br /><br />{$this->lang->words['last_upload']}: " . $this->registry->getClass('class_localization')->getDate($data['album_last_img_date'],"DATE", 0) . "
						") : ("")) . "
					</td>
				</tr>
			
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}


}


/*--------------------------------------------------*/
/* END OF FILE                                      */
/*--------------------------------------------------*/

?>