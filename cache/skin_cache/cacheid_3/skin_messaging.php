<?php
/*--------------------------------------------------*/
/* FILE GENERATED BY INVISION POWER BOARD 3         */
/* CACHE FILE: Skin set id: 3               */
/* CACHE FILE: Generated: Wed, 29 Aug 2012 14:15:03 GMT */
/* DO NOT EDIT DIRECTLY - THE CHANGES WILL NOT BE   */
/* WRITTEN TO THE DATABASE AUTOMATICALLY            */
/*--------------------------------------------------*/

class skin_messaging_3 extends skinMaster{

/**
* Construct
*/
function __construct( ipsRegistry $registry )
{
	parent::__construct( $registry );
	

$this->_funcHooks = array();
$this->_funcHooks['messengerTemplate'] = array('isMemberPartOpen','isMemberPartFloat','isMemberPartClose','userIsStarter','lastReadTime','messageIsDeleted','notification','blockUserLink','unbanUserLink','systemMessage','topicUnavailable','userIsBanned','userIsActive','participants','protectedFolder','allFolder','unprotectedFolder','dirs','PMDisabled','changeNotifications','unlimitedInvites','inviteMoreParticipants','hasParticipants','myDirectories','almostFull','storageBar','inlineError');
$this->_funcHooks['sendReplyForm'] = array('replyForm');
$this->_funcHooks['showConversation'] = array('reportPm','canEdit','canDelete','quickReply','replies','canReplyEditor');
$this->_funcHooks['showFolder'] = array('messages');


}

/* -- messengerDisabled --*/
function messengerDisabled() {
$IPBHTML = "";
$IPBHTML .= "<error>Messanger Disabled</error>";
return $IPBHTML;
}

/* -- messengerTemplate --*/
function messengerTemplate($html, $jumpmenu, $dirData, $totalData=array(), $topicParticipants=array(), $inlineError='', $deletedTopic=0) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_messaging', $this->_funcHooks['messengerTemplate'] ) )
{
$count_6e8d0ca244caed0d299b7095d7edb0e0 = is_array($this->functionData['messengerTemplate']) ? count($this->functionData['messengerTemplate']) : 0;
$this->functionData['messengerTemplate'][$count_6e8d0ca244caed0d299b7095d7edb0e0]['html'] = $html;
$this->functionData['messengerTemplate'][$count_6e8d0ca244caed0d299b7095d7edb0e0]['jumpmenu'] = $jumpmenu;
$this->functionData['messengerTemplate'][$count_6e8d0ca244caed0d299b7095d7edb0e0]['dirData'] = $dirData;
$this->functionData['messengerTemplate'][$count_6e8d0ca244caed0d299b7095d7edb0e0]['totalData'] = $totalData;
$this->functionData['messengerTemplate'][$count_6e8d0ca244caed0d299b7095d7edb0e0]['topicParticipants'] = $topicParticipants;
$this->functionData['messengerTemplate'][$count_6e8d0ca244caed0d299b7095d7edb0e0]['inlineError'] = $inlineError;
$this->functionData['messengerTemplate'][$count_6e8d0ca244caed0d299b7095d7edb0e0]['deletedTopic'] = $deletedTopic;
}
$IPBHTML .= "" . $this->registry->getClass('output')->addJSModule("messenger", "0" ) . "
<script type=\"text/javascript\">
	ipb.messenger.disabled  = " . intval($this->memberData['members_disable_pm']) . ";
</script>
" . (($this->memberData['members_disable_pm']) ? ("
<noscript>
	" . ( method_exists( $this->registry->getClass('output')->getTemplate('messaging'), 'messengerDisabled' ) ? $this->registry->getClass('output')->getTemplate('messaging')->messengerDisabled() : '' ) . "
</noscript>
") : ("")) . "
<div id='messenger_utilities' class='left'>
	<!-- Show topic participants -->
	" . ((is_array( $topicParticipants ) and count( $topicParticipants )) ? ("<div class='ipsSideBlock' id='participants'>
			<h3 class='bar'>{$this->lang->words['participants']}</h3>
			<ul id='participants_list' class='ipsList_withminiphoto'>
				".$this->__f__106c1a501c86e9c57b74538625f04585($html,$jumpmenu,$dirData,$totalData,$topicParticipants,$inlineError,$deletedTopic)."					
			</ul>
			<ul class='post_controls'>
				<li>
					<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=view&amp;do=toggleNotifications&amp;topicID={$this->request['topicID']}&amp;authKey={$this->member->form_hash}", "publicWithApp",'' ), "", "" ) . "' title='{$this->lang->words['toggle_noti_title']}'>
					" . (($topicParticipants[ $this->memberData['member_id'] ]['map_ignore_notification']) ? ("
						{$this->lang->words['turn_noti_on']}
					") : ("
						{$this->lang->words['turn_noti_off']}
					")) . "
					</a>
				</li>
			</ul>
		</div>
		" . (($this->memberData['g_max_mass_pm'] && count( $topicParticipants ) < $this->memberData['g_max_mass_pm'] && ! $deletedTopic) ? ("<div id='invite_more' class='ipsSideBlock'>
				<h3>{$this->lang->words['invite_part']}</h3>
				<div id='invite_more_dialogue'>
					<form method='post' action='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=members&amp;module=messaging&amp;section=view&amp;do=addParticipants", "public",'' ), "", "" ) . "'>
					<input type='hidden' name='authKey' value='{$this->member->form_hash}' />
					<input type='hidden' name='topicID' value='{$this->request['topicID']}' />
					<input type='hidden' name='st' value='{$this->request['st']}' />
					<ul><li><label for='invite_more_autocomplete'>{$this->lang->words['enter_member_names']}</label> 
					<input type='text' class='input_text' name='inviteNames' id='invite_more_autocomplete' value='{$this->request['inviteNames']}' size='38' /> 
					<br /><span class='desc'>[x]{$this->lang->words['separated_with_commas']}</span> 
					</li></ul><fieldset class='submit'><input type='submit' class='input_submit' value='{$this->lang->words['part_add']}' />  
					{$this->lang->words['or']} <a href='#' id='invite_more_cancel' class='cancel' title='{$this->lang->words['cancel']}'>{$this->lang->words['cancel']}</a></fieldset></form>
				</div>
				<div id='invite_more_default'>
					" . (($this->memberData['g_max_mass_pm'] == 0) ? ("
						<p class='desc'>{$this->lang->words['can_invite_unlimited']}</p>
						<script type='text/javascript'>
							ipb.messenger.invitesLeft = parseInt( 0 );
							ipb.messenger.nameText = ipb.lang['enter_unlimited_names'];
						</script>
					") : ("
						<p class='desc'>{$this->lang->words['may_invite_upto']} <strong>" . ( $this->memberData['g_max_mass_pm'] - count( $topicParticipants ) ) . "</strong> {$this->lang->words['more_members']}</p>
						<script type='text/javascript'>
							ipb.messenger.invitesLeft = parseInt( " . ( $this->memberData['g_max_mass_pm'] - count( $topicParticipants ) ) . " );
							ipb.messenger.nameText = ipb.lang['enter_x_names'].gsub(/\\[x\\]/, ipb.messenger.invitesLeft);
						</script>
					")) . "
					<ul class='post_controls'>
						<li id='add_participants'><a href='#' title='{$this->lang->words['add_participants']}'>{$this->lang->words['part_add']}</a></li>
					</ul>
				</div>
			</div>") : ("")) . "") : ("")) . "
	<div id='folder_list' class='ipsSideBlock'>
		<h3>{$this->lang->words['folders']}</h3>
		<ol id='folders'>
			" . ((count($dirData)) ? ("
				".$this->__f__f6041987a232ddfb5fbd40102a4e551d($html,$jumpmenu,$dirData,$totalData,$topicParticipants,$inlineError,$deletedTopic)."			") : ("")) . "
		</ol>
		<div class='clearfix post_controls'>
			<ul class='post_controls'>
				<li id='add_folder'><a href='#' title='{$this->lang->words['add_folder']}'>{$this->lang->words['folder_add']}</a></li>
				<li id='edit_folders'><a href='#' title='{$this->lang->words['edit_folders']}'>{$this->lang->words['folders_edit']}</a></li>
			</ul>
		</div>
		<script type='text/javascript'>
		//<![CDATA[
			ipb.messenger.folderTemplate = \"<li class='folder' id='f_[id]'>" . $this->registry->getClass('output')->getReplacement("folder_generic") . " <a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=view&amp;do=showFolder&amp;folderID=[id]", "publicWithApp",'' ), "", "" ) . "' title='{$this->lang->words['go_to_folder']}' rel='folder_name'>[name]</a> <span class='total rounded'>[total]</span><span class='edit_folders' style='display: none'><a href='#' id='delete_[id]' class='f_delete' title='{$this->lang->words['delete_folder_title']}'>" . $this->registry->getClass('output')->getReplacement("folder_delete") . "</a> <a href='#' id='empty_[id]' class='f_empty' title='{$this->lang->words['empty_folder_title']}'>" . $this->registry->getClass('output')->getReplacement("folder_empty") . "</a></span></li>\";
		//]]>
		</script>
	</div>
	" . (($this->memberData['g_max_messages'] > 0) ? ("<div id='space_allowance' class='ipsSideBlock'>
			<h3>{$this->lang->words['storage']}</h3>
			<p>{$this->lang->words['your_messenger_storage']}</p>
			<p class='progress_bar' title='" . sprintf( $this->lang->words['pmpc_full_string'], $totalData['full_percent'] ) . "' " . (($totalData['full_percent'] > 80) ? ("class='limit'") : ("")) . ">
				<span style='width: {$totalData['full_percent']}%'>{$totalData['full_percent']}%</span>
			</p>
			<p>
				<span class='desc'>{$totalData['full_percent']}% {$this->lang->words['of_your_quota']} ({$this->memberData['g_max_messages']} {$this->lang->words['messages']})</span>
			</p>
		</div>") : ("")) . "
	<div id='message_search' class='ipsSideBlock'>
		<h3>{$this->lang->words['search_messages']}</h3>
		<form action='{$this->settings['base_url']}app=members&amp;module=messaging&amp;section=search' method='post'>
			<fieldset>
				<input type='text' name='searchFor' class='input_text' size='15' style='width: 60%' /> <input type='submit' class='input_submit' value='{$this->lang->words['jmp_go']}' />
			</fieldset>
		</form>
	</div>
	<br />
	
	<a class='ipsButton_secondary cancel' href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=view&amp;do=disableMessenger&amp;authKey={$this->member->form_hash}", "publicWithApp",'' ), "", "" ) . "\"'>{$this->lang->words['disable_messenger']}</a>
	<!--<ul class='topic_buttons'>
		<li class='important'></li>
	</ul>-->
</div>
<div id='messenger_content' class='right'>
	" . (($inlineError) ? ("
	<div class='message error'>
		<h4>{$inlineError}</h4>
	</div>
	<br />
	") : ("")) . "
	{$html}
</div>
<!-- end -->
<div id='pmDisabled' style='display:none'>
	" . ( method_exists( $this->registry->getClass('output')->getTemplate('messaging'), 'messengerDisabled' ) ? $this->registry->getClass('output')->getTemplate('messaging')->messengerDisabled() : '' ) . "
</div>
<br class='clear' />";
return $IPBHTML;
}


function __f__106c1a501c86e9c57b74538625f04585($html, $jumpmenu, $dirData, $totalData=array(), $topicParticipants=array(), $inlineError='', $deletedTopic=0)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $topicParticipants as $memberID => $memberData )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
					<li class='clearfix'>
						" . (($memberData['member_id']) ? ("<a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "showuser={$memberData['member_id']}", "public",'' ), "{$memberData['members_seo_name']}", "showuser" ) . "' title='{$this->lang->words['view_profile']}' class='ipsUserPhotoLink left'>") : ("")) . "<img src='{$memberData['pp_small_photo']}' alt='{$this->lang->words['photo']}' class='ipsUserPhoto ipsUserPhoto_mini" . ((!$memberData['member_id']) ? (" left") : ("")) . "' />" . (($memberData['member_id']) ? ("</a>") : ("")) . "
						<p class='list_content'>
							" . (($memberData['map_user_active']) ? ("" . (($memberData['map_is_starter']) ? ("
									<span class='name starter'>" . ( method_exists( $this->registry->getClass('output')->getTemplate('global'), 'userHoverCard' ) ? $this->registry->getClass('output')->getTemplate('global')->userHoverCard($memberData) : '' ) . "</span>
								") : ("
									<span class='name'>" . ( method_exists( $this->registry->getClass('output')->getTemplate('global'), 'userHoverCard' ) ? $this->registry->getClass('output')->getTemplate('global')->userHoverCard($memberData) : '' ) . "</span>
								")) . "
								<br />
								<span class='ipsType_smaller desc'>
									" . (($memberData['_topicDeleted']) ? ("
										<em>{$this->lang->words['topic_deleted']}</em>
									") : ("{$this->lang->words['last_read']}
										" . (($memberData['map_read_time']) ? ("
											" . $this->registry->getClass('class_localization')->getDate($memberData['map_read_time'],"short", 0) . "
										") : ("
											<em>{$this->lang->words['not_yet_read']}</em>
										")) . "")) . "
									" . (($memberData['map_ignore_notification']) ? ("
										<span class='ipsBadge ipsBadge_lightgrey right'>{$this->lang->words['msg_no_notify']}</span>
									") : ("")) . "						
								</span>
								" . ((! $memberData['map_is_starter'] AND $memberData['_canBeBlocked'] AND ($topicParticipants[ $this->memberData['member_id'] ]['map_is_starter'] OR $this->memberData['g_is_supmod']) AND ( $memberData['map_user_id'] != $this->memberData['member_id'] ) AND !$memberData['_topicDeleted']) ? ("
									<br /><a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=view&amp;do=blockParticipant&amp;topicID={$this->request['topicID']}&amp;memberID={$memberData['map_user_id']}&amp;authKey={$this->member->form_hash}", "publicWithApp",'' ), "", "" ) . "\" title='{$this->lang->words['block_this_user']}' class='cancel'>{$this->lang->words['block']}</a>
								") : ("")) . "") : ("" . (($memberData['map_user_banned']) ? ("<span class='name blocked'><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "showuser={$memberData['member_id']}", "public",'' ), "{$memberData['members_seo_name']}", "showuser" ) . "' title='{$this->lang->words['view_profile']}'><strong>{$memberData['members_display_name_short']}</strong></a></span>
									<br />
									<span class='desc'>{$this->lang->words['user_is_blocked']}</span>
									<br />
									" . (($memberData['_canBeBlocked'] AND ($topicParticipants[ $this->memberData['member_id'] ]['map_is_starter'] OR $this->memberData['g_is_supmod'])) ? ("
										<a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=view&amp;do=unblockParticipant&amp;topicID={$this->request['topicID']}&amp;memberID={$memberData['map_user_id']}&amp;authKey={$this->member->form_hash}", "publicWithApp",'' ), "", "" ) . "\" title='{$this->lang->words['unblock_this_user']}' class='cancel'>{$this->lang->words['unblock']}</a>
									") : ("")) . "") : ("<span class='name left_convo'><a href='" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "showuser={$memberData['member_id']}", "public",'' ), "{$memberData['members_seo_name']}", "showuser" ) . "' title='{$this->lang->words['view_profile']}'><strong>{$memberData['members_display_name_short']}</strong></a></span>
									<br />
									<span class='desc'>
										" . (($memberData['_topicDeleted']) ? ("
										<em>{$this->lang->words['topic_deleted']}</em>
										") : ("" . (($memberData['map_is_system']) ? ("
												{$this->lang->words['is_unable_part']}
											") : ("
												{$this->lang->words['has_left_convo']}
											")) . "")) . "
									</span>")) . "")) . "
						</p>
					</li>
				
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

function __f__f6041987a232ddfb5fbd40102a4e551d($html, $jumpmenu, $dirData, $totalData=array(), $topicParticipants=array(), $inlineError='', $deletedTopic=0)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $dirData as $id => $data )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
					" . (($data['protected']) ? ("
						<li class='folder protected' id='f_{$id}'>" . $this->registry->getClass('output')->getReplacement("folder_{$id}") . "
					") : ("
						<li class='folder' id='f_{$id}'>" . $this->registry->getClass('output')->getReplacement("folder_generic") . "
					")) . "
					<a href=\"" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=view&amp;do=showFolder&amp;folderID={$id}", "publicWithApp",'' ), "", "" ) . "\" title=\"{$this->lang->words['go_to_folder']}\" rel=\"folder_name\">{$data['real']}</a>
					<span class='total rounded'>
						" . (($id == 'all') ? ("
							" . intval($this->memberData['msg_count_total']) . "
						") : ("
							" . intval($data['count']) . "
						")) . "
					</span>
					" . ((! $data['protected']) ? ("
						<span class='edit_folders' style='display: none'><a href='#' id='delete_{$id}' class='f_delete' title=\"{$this->lang->words['delete_folder_title']}\">" . $this->registry->getClass('output')->getReplacement("folder_delete") . "</a> <a href='#' id='empty_{$id}' class='f_empty' title=\"{$this->lang->words['empty_folder_title']}\">" . $this->registry->getClass('output')->getReplacement("folder_empty") . "</a></span></li>
					") : ("
						<span class='edit_folders' style='display: none'><a href='#' id='empty_{$id}' class='f_empty' title=\"{$this->lang->words['empty_folder_title']}\">" . $this->registry->getClass('output')->getReplacement("folder_empty") . "</a></span></li>
					")) . "
				
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- PMQuickForm --*/
function PMQuickForm($toMemberData) {
$IPBHTML = "";
$IPBHTML .= "<!-- NoData -->";
return $IPBHTML;
}

/* -- sendNewPersonalTopicForm --*/
function sendNewPersonalTopicForm($displayData) {
$IPBHTML = "";
$IPBHTML .= "<!-- NoData -->";
return $IPBHTML;
}

/* -- sendReplyForm --*/
function sendReplyForm($displayData) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_messaging', $this->_funcHooks['sendReplyForm'] ) )
{
$count_9ef02ca46324ca90ac9b578e5bb34f24 = is_array($this->functionData['sendReplyForm']) ? count($this->functionData['sendReplyForm']) : 0;
$this->functionData['sendReplyForm'][$count_9ef02ca46324ca90ac9b578e5bb34f24]['displayData'] = $displayData;
}
$IPBHTML .= "<postingForm>
	<msgID>{$displayData['msgID']}</msgID>
	<topicID>{$displayData['topicID']}</topicID>
	<postKey>{$displayData['postKey']}</postKey>
	{$displayData['editor']}
	<authKey>{$this->member->form_hash}</authKey>
	
	" . (($displayData['type'] == 'reply') ? ("
			<submitURL><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=send&amp;do=sendReply", "publicWithApp",'' ), "", "" ) . "]]></submitURL>
	") : ("
			<submitURL><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=send&amp;do=sendEdit", "publicWithApp",'' ), "", "" ) . "]]></submitURL>
	")) . "
	
</postingForm>";
return $IPBHTML;
}

/* -- showConversation --*/
function showConversation($topic, $replies, $members, $jump="") {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_messaging', $this->_funcHooks['showConversation'] ) )
{
$count_9f4a35d1dc7d1836e08999825b97970a = is_array($this->functionData['showConversation']) ? count($this->functionData['showConversation']) : 0;
$this->functionData['showConversation'][$count_9f4a35d1dc7d1836e08999825b97970a]['topic'] = $topic;
$this->functionData['showConversation'][$count_9f4a35d1dc7d1836e08999825b97970a]['replies'] = $replies;
$this->functionData['showConversation'][$count_9f4a35d1dc7d1836e08999825b97970a]['members'] = $members;
$this->functionData['showConversation'][$count_9f4a35d1dc7d1836e08999825b97970a]['jump'] = $jump;
}
$IPBHTML .= "<template>messageView</template>
<pagination>{$topic['_pages']}</pagination>
" . (($topic['_canReply']) ? ("
<AssessoryButtonURL><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=members&amp;module=messaging&amp;section=send&amp;do=sendReply&amp;topicID={$topic['mt_id']}", "public",'' ), "", "" ) . "]]></AssessoryButtonURL>
") : ("")) . "
<message>
	<title><![CDATA[{$topic['mt_title']}]]></title>
	".$this->__f__56bbc7ad2ffaad3a54726367aa127d26($topic,$replies,$members,$jump)."</message>";
return $IPBHTML;
}


function __f__56bbc7ad2ffaad3a54726367aa127d26($topic, $replies, $members, $jump="")
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $replies as $msg_id => $msg )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
		<messageReply>
			<user>
				<id>{$msg['msg_author_id']}</id>
				<name><![CDATA[{$members[ $msg['msg_author_id'] ]['members_display_name']}]]></name>
				<date>" . $this->registry->getClass('class_localization')->getDate($msg['msg_date'],"DATE", 0) . "</date>
				<avatar><![CDATA[{$members[ $msg['msg_author_id'] ]['pp_thumb_photo']}]]></avatar>
				<url><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "showuser={$msg['msg_author_id']}", "public",'' ), "{$members[ $msg['msg_author_id'] ]['members_seo_name']}", "showuser" ) . "]]></url>
			</user>	
			<date>" . $this->registry->getClass('class_localization')->getDate($msg['post']['post_date'],"DATE", 0) . "</date>
			<text><![CDATA[{$msg['msg_post']}
			{$msg['attachmentHtml']}]]></text>
			<options>
			" . (($topic['_canReport'] and $this->memberData['member_id']) ? ("
				<reportURL><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=core&amp;module=reports&amp;rcom=messages&amp;topicID={$this->request['topicID']}&amp;st={$this->request['st']}&amp;msg={$msg['msg_id']}", "public",'' ), "", "" ) . "]]></reportURL>
			") : ("")) . "
			
			" . (($msg['_canEdit'] === TRUE) ? ("
				<editURL><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=send&amp;do=editMessage&amp;topicID={$topic['mt_id']}&amp;msgID={$msg['msg_id']}", "publicWithApp",'' ), "", "" ) . "]]></editURL>
			") : ("")) . "
			
			" . (($msg['_canDelete'] === TRUE && $msg['msg_is_first_post'] != 1) ? ("
				<deleteURL><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=send&amp;do=deleteReply&amp;topicID={$topic['mt_id']}&amp;msgID={$msg['msg_id']}&amp;authKey={$this->member->form_hash}", "publicWithApp",'' ), "", "" ) . "]]></deleteURL>
			") : ("")) . "
			
			" . (($topic['_canReply'] AND empty( $topic['_everyoneElseHasLeft'] )) ? ("
				<replyURL><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "module=messaging&amp;section=send&amp;do=replyForm&amp;topicID={$topic['mt_id']}&amp;msgID={$msg['msg_id']}", "publicWithApp",'' ), "", "" ) . "]]></replyURL>
			") : ("")) . "
				</options>							
		</messageReply>
	
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- showConversationForArchive --*/
function showConversationForArchive($topic, $replies, $members) {
$IPBHTML = "";
$IPBHTML .= "<!-- NoData -->";
return $IPBHTML;
}

/* -- showFolder --*/
function showFolder($messages, $dirname, $pages, $currentFolderID, $jumpFolderHTML) {
$IPBHTML = "";
if( IPSLib::locationHasHooks( 'skin_messaging', $this->_funcHooks['showFolder'] ) )
{
$count_37102c4700f78aecf5e4bff2fe5fd607 = is_array($this->functionData['showFolder']) ? count($this->functionData['showFolder']) : 0;
$this->functionData['showFolder'][$count_37102c4700f78aecf5e4bff2fe5fd607]['messages'] = $messages;
$this->functionData['showFolder'][$count_37102c4700f78aecf5e4bff2fe5fd607]['dirname'] = $dirname;
$this->functionData['showFolder'][$count_37102c4700f78aecf5e4bff2fe5fd607]['pages'] = $pages;
$this->functionData['showFolder'][$count_37102c4700f78aecf5e4bff2fe5fd607]['currentFolderID'] = $currentFolderID;
$this->functionData['showFolder'][$count_37102c4700f78aecf5e4bff2fe5fd607]['jumpFolderHTML'] = $jumpFolderHTML;
}
$IPBHTML .= "<template>popoverMessages</template>
<messages>
	".$this->__f__812a883f2bc065b26cbd773b2db4ba61($messages,$dirname,$pages,$currentFolderID,$jumpFolderHTML)."</messages>";
return $IPBHTML;
}


function __f__812a883f2bc065b26cbd773b2db4ba61($messages, $dirname, $pages, $currentFolderID, $jumpFolderHTML)
{
	$_ips___x_retval = '';
	$__iteratorCount = 0;
	foreach( $messages as $message )
	{
		
		$__iteratorCount++;
		$_ips___x_retval .= "
		<message>
			<id>{$message['msg_topic_id']}</id>
			<title>{$message['mt_title']}</title>
			<url><![CDATA[" . $this->registry->getClass('output')->formatUrl( $this->registry->getClass('output')->buildUrl( "app=members&amp;module=messaging&amp;section=view&amp;do=showConversation&amp;topicID={$message['msg_topic_id']}", "public",'' ), "", "" ) . "]]></url>
			<SenderName><![CDATA[{$message['_starterMemberData']['members_display_name']}]]></SenderName>
			<icon><![CDATA[{$message['_starterMemberData']['pp_mini_photo']}]]></icon>
		</message>
	
";
	}
	$_ips___x_retval .= '';
	unset( $__iteratorCount );
	return $_ips___x_retval;
}

/* -- showSearchResults --*/
function showSearchResults($messages, $pages, $error) {
$IPBHTML = "";
$IPBHTML .= "<!-- NoData -->";
return $IPBHTML;
}


}


/*--------------------------------------------------*/
/* END OF FILE                                      */
/*--------------------------------------------------*/

?>